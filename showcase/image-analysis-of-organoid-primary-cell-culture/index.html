<!DOCTYPE html>
<html lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <title>//sndbx.be is not science</title>
        <style type="text/css" title="layout">
		  @import "../../static/css/solarized_dark.css";
          @import "../../static/css/style.css";
@import "../../static/css/jquery.fancybox.css";        </style>
        <script src="../../static/scripts/jquery-1.7.2.min.js"></script>
		<!-- Using MathJax, with the delimiters $ -->
		<!-- Conflict with pygments for the .mo and .mi -->
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
		  "HTML-CSS": {
		  styles: {
		  ".MathJax .mo, .MathJax .mi": {color: "black ! important"}}
		  },
		  tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']],processEscapes: true},
		  TeX: { equationNumbers: { autoNumber: "AMS" } }
		  });
		</script>

	   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
            <script type="text/javascript">

              var _gaq = _gaq || [];
              _gaq.push(['_setAccount', 'UA-41003145-2']);
              _gaq.push(['_trackPageview']);

              (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
              })();
            </script>
        <script src="../../static/scripts/jquery.fancybox.pack.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $('.fancybox').fancybox({
                openEffect  : 'none',
                closeEffect : 'none',
                padding : 0,
                beforeLoad: function() {
                    var el, id = $(this.element).data('title-id');

                    if (id) {
                        el = $('#' + id);
                    
                        if (el.length) {
                            this.title = el.html();
                        }
                    }
                },
                afterShow: function() {
                    $(".fancybox-title").wrapInner('<div />').show();
                    
                    $(".fancybox-wrap").hover(function() {
                        $(".fancybox-title").show();
                    }, function() {
                        $(".fancybox-title").hide();
                    });
                },
                helpers : {
                    title: {
                        type: 'over'
                    }
                }

                });
            });
        </script>
    </head>
    <body>

        <div id="container">
        	<div id="header-wrapper">

				<div id="header">
					<h1><a href="../.." title="home">//sndbx.be</a></h1>
				</div>
				<div id='nav'>
					 <ul>
						<li style="border-left: none;" ><a  class="active"  href="../../">blog</a></li>
						<li><a  href="../../showcase/">showcase</a></li>
						<li><a  href="../../about/">about</a></li>
					</ul>
				</div>
			</div>
			<div id="my_fixable_header">...</div>
            <div id="mainContent"><h1>Image analysis of <em>organoid</em> primary cell culture</h1>
<div id="printheader"><h2>Emiliano Izquierdo</h2></div><div id="wdate">&mdash; written on Saturday, October 26, 2013</div>		<blockquote class="break"><p><em>Organoids are three-dimensional tissue structures grown in culture from a single adult stem cell of the mouse small intestine. Its shape and physiology resemble the in-vivo situation, which makes them a very suitable model for studying tissue renewal and morphogenesis. Here, timelapse fluorescence microscopy images from the organoid growth were analyzed with state-of-the-art algorithms for cell tracking.</em></p></blockquote>
	<p><strong>Note about figures:</strong> Figures are not displayed. To see the figure please make sure Javascript is enabled, and click on the corresponding link, caption can be unhidden by mouse hover once the image is displayed.</p>
<div class="toc">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#developmental-phenotypes-through-imaging">Developmental phenotypes through imaging</a></li>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#objectives">Objectives</a></li>
<li><a href="#system-under-investigation">System under investigation</a></li>
</ul>
</li>
<li><a href="#experimental-approach">Experimental Approach</a><ul>
<li><a href="#organoid-primary-culture-preparation">Organoid primary culture preparation</a></li>
<li><a href="#image-acquisition">Image acquisition</a></li>
</ul>
</li>
<li><a href="#results-and-discussion">Results and discussion</a><ul>
<li><a href="#image-analysis">Image analysis</a><ul>
<li><a href="#segmentation">Segmentation</a></li>
<li><a href="#object-extraction-and-classification">Object extraction and classification</a></li>
<li><a href="#tracking">Tracking</a></li>
<li><a href="#implementation-of-an-edge-aware-penalty-function">Implementation of an edge-aware penalty function</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#concluding-remarks">Concluding remarks</a></li>
<li><a href="#aknowledgements">Aknowledgements</a></li>
</ul>
</div>
<h1 id="introduction">Introduction</h1>
<hr />
<p>Organoids are crypt-villus shaped structures established from long term expansion of self-renewing stems cells of the mouse small-intestine epithelium. In the in-vivo situation for mouse, the small intestine is established from a single layer of cells, and arises from the vigorous proliferation of epithelial tissue around embryonic day 14.5 (E14.5). In later stages, the epithelium is shaped into protrusions (the prospective villi) while cell proliferation is restricted to small compartments which after the third week mature into crypts (E18.5). The native epithelial tissue has a distinctive hierarchical structure where around 15 stem cells reside at the position +4 dividing every 24 hours, other types of cells, the Paneth cells, occupy the positions 1 to 3 from the bottom. Furthermore, stem cells produce rapidly proliferating cells (transit amplifying) which generate 16 to 32 new cells that later stochastically adopt a stem cell fate or differentiate into one mature cell lineage depending on the available space (<a href="#Radtke2005">Radtke &amp; Clevers 2005</a>, <a href="#Sato2013">Sato &amp; Clevers 2013</a>). Committed cells from neighboring crypts migrate toward one common villus tip, hence, villi origin is said to be polyclonal (Schmidt et al. 1988). In mouse, this tissue is known to have rapid regeneration cycles with a turnover rate of around 5 days where tissue homeostasis is balanced by apoptosis at the tip of the villi. This specific portion of the mouse and also from the human anatomy has been well studied in an effort to understand the process of tissue development and the role of adult stem-cells in regeneration (see <b><a class="fancybox" rel="organoid" data-title-id="caption-1" href="/static/images/organoid/villus-crypt.png" title="click to enlarge">Figure 1</a></b>). 
<div class="img-print"><img src="/static/images/organoid/villus-crypt.png" alt="click to enlarge"/></div>
<div id="caption-1" class="caption-print"><b>Figure 1. Anatomy of the crypt-villus structure in the adult small intestine. </b>Villi are formed from the differentiation (green) and migration of cells proliferating (light blue) in the crypt domain. Cells with stem cell properties (dark blue) reside above Paneth cells (yellow) near the crypt bottom. (image from <a href="#Reya2005">Reya &amp; Clevers 2005</a>)</div></p>
<p>In recent years, the establishment of advanced culture systems enabling the long term expansion and preservation of the basic physiology of tissues has allowed the isolation of complex three-dimensional structures like the crypt-villus epithelium. Such an ex-vivo system permits for a more controlled experimental setup while characteristics that resemble the native gut environment are maintained, for example: i) stem-cell hierarchy and self-renewal, ii) cell type composition, and iii) multi-domain architecture (<a href="#Sato2009">Sato et al. 2009</a>). It has been proven that these self-organizing structures arise not only from entire isolated crypts but from single stem cells (<a href="#Barker2007">Barker et al. 2007</a>). In short, organoids constitute an ideal ex-vivo model for the understanding of the key events underlying the tissue regeneration and morphogenesis (see <b><a class="fancybox" rel="organoid" data-title-id="caption-2" href="/static/images/organoid/organoid-growth2.png" title="click to enlarge">Figure 2</a></b>).
<div class="img-print"><img src="/static/images/organoid/organoid-growth2.png"/></div><div id="caption-2" class="caption-print"><b>Figure 2. Organoids basic culture system.</b> <strong>A.</strong> Cells from the mouse crypt are enzymatically segregated and Lgr5<sup>+</sup> (fluorescent marker) cells are sorted (FACS) and embedded in <em>Matrigel</em> culture medium containing growth factors: EGF, Noggin, and R-spondin. <strong>B.</strong> A single cell grows to initially form a sphere shaped cell layer. Later, the symmetrical shape is broken by the growth of a protrusion. Lgr5<sup>+</sup> cells (in yellow) interact with Paneth cells (blue) to initiate the bud formation. (image from <a href="#Sato2013">Sato &amp; Clevers 2013</a>)</div></p>
<h2 id="developmental-phenotypes-through-imaging">Developmental phenotypes through imaging</h2>
<p>The process in which a tissue gains its shape and identity requires knowledge of the dynamical processes in which the behavior of a cell (as a developmental unit) responds to neighboring signals in a controlled manner. Both spatial and temporal events should be recorded to finally achieve an integrated picture of morphogenesis, covering important cues from the single to the tissue level. Both imaging technologies and computational tools currently provide mechanisms in which development up to the single cell resolution can be achieved. </p>
<p>Relatively new microscopy techniques aiming for live imaging of entire embryos have overcome the limitations of previous imaging methods (as Laser scanning microscopy, LSM). Speed and depth limits are increased as well as photobleaching and phototoxicity are reduced simply by orthogonal structured illumination and parallel acquisition of entire micrometer thin volumes (<a href="#Huizken2004">Huisken et al. 2004</a>, <a href="#Keller2008">Keller et al. 2008</a>). The continuous development of platforms based on selective-plane-illumination-microscopy (SPIM), introduced to biology in 2004 (<a href="#Huizken2004">Huisken et al. 2004</a>), allows the continuous monitoring of the morphogenesis of entire embryos up to several days with minimal disruption.</p>
<p>Great amount of imaging data is generated continuously, likewise algorithms capable of handling that information are improving. The quantitative data analysis of time-lapse recording demands a simple automated, efficient and robust computational solution. While the first efforts for segmentation and tracking of single GFP stained cell-nuclei required more than 4000 cores of computational power (<a href="#Keller2008">Keller et al. 2008</a>), today's solutions can be boiled down to a single multi-core personal computer (<a href="#Kausler2012">Kausler et al. 2012</a>, <a href="#Schiegg2013">Schiegg et al. 2013</a>). With the help of these algorithms, a typical 3D + time dataset can be segmented. Likewise, cell identities are tracked and cell behavior can be systematically analyzed throughout development (see <b><a class="fancybox" rel="organoid" data-title-id="caption-3" href="/static/images/organoid/quantitative-workflow.png" title="click to enlarge">Figure 3</a></b>).
<div class="img-print"><img src="/static/images/organoid/quantitative-workflow.png"/></div>
<div id="caption-3" class="caption-print"><b>Figure 3. Image based study of morphogenesis. </b><strong>A.</strong> Various kinds of quantitative information can be extracted from time-lapse image data like: <strong>B.</strong> i) Expression from proliferation, cell-death or cell-type specific makers, ii) division events, or iii) spatial arrangements. These measurements are then translated into a description of various biological processes as lineage tree, tissue renewal/proliferation, morphology/shape architecture. <strong>C.</strong> Measurements from multiple experiments can be compared for between each cell. For example, the comparison of mutant vs. the wild-type where measurements above the wild-type mean are in red while measurements below are in blue.  (image from <a href="#Moore2013">Moore et al. 2013</a>)</div></p>
<p>Here we employ an updated version of <em><a href="http://ilastik.org">ILASTIK</a></em> &mdash;an interactive learning, segmentation and tracking toolkit&mdash; (<a href="#Sommer2011">Sommer et al. 2011</a>) to the multidimensional analysis of spinning disc confocal microscopy recordings of the organoid tissue culture (see <strong><a href="#figure-6">Figure 6a</a></strong>).</p>
<h2 id="motivation">Motivation</h2>
<p>Knowledge acquisition of the mechanical, biochemical and temporal cues of the organoids will provide more insight into the self-organizing principles of development, specially of organogenesis and tissue morphogenesis. The standardization of a pipeline for temporally tracking spatial arrangements of cells while capturing proliferation events will eventually serve as a platform for functional analysis and further ex-vivo experiments in an isolated setup. In the future the analysis could be applied to knock-out/knock-in mouse strains, as well as to assays in which stimulation with a signaling molecule is induced; good examples are the morphogenic response to induction of known developmental signaling pathways as Wnt-$\beta$-Catenin, bone morphogenic protein and Notch (<a href="#Reya2005">Reya &amp; Clevers 2005</a>).</p>
<h2 id="objectives">Objectives</h2>
<ol>
<li>Use <em>ILASTIK</em> for tracking fluorescently stained nuclei of the organoid tissue culture.</li>
</ol>
<h2 id="system-under-investigation">System under investigation</h2>
<p>In culture, the organoid (100-250 μm in diameter) three dimensional structure arises from single sorted/selected Lgr5<sup>+</sup> cells which by multiple division events, self-organize into ordered crypt-villus domains (<a href="#Barker2007">Barker et al. 2007</a>).This architecture is compared to the native small-intestine epithelium by the formation of analogous domains (see <b><a class="fancybox" rel="organoid" data-title-id="caption-4" href="/static/images/organoid/organoid-structure.png" title="click to enlarge">Figure 4</a></b>). The complexity of the organization not only encompasses the spatial arrangement but also the cell type distribution along space and time.<div class="img-print"><img src="/static/images/organoid/organoid-structure.png" alt="click to enlarge"/></div>
<div id="caption-4" class="caption-print"><b>Figure 4. The organoid. </b> <strong>d.</strong> Lgr5<sup>+</sup> cells (green) on the tip of the analogous structures to the mouse small-intestine crypts in a three-dimensional reconstruction of confocal microscopy images. <strong>e.</strong> Schematic representation of the organoid with its analogous domains: the crypt, and the villus-like epithelium facing the internal lumen. (from <a href="#Moore2013">Moore et al. 2013</a>)</div> </p>
<p>Organoids were genetically manipulated to incorporate a cassette with <em>C-terminal tagEGFP-IRES:neo</em> flanked by loxP recombination sites, the vector was designed for driving H2A-EGFP fusion and the integration of (neo)mycine resistance marker for selection with G418 (<a href="#Schwank2013">Schwank et al. 2013</a>). During growth, time-lapse recordings of the organoid fluorescently stained nuclei were performed using a spinning disc microscope.</p>
<h1 id="experimental-approach">Experimental Approach</h1>
<hr />
<h2 id="organoid-primary-culture-preparation">Organoid primary culture preparation</h2>
<p><em><strong>Methods remarks:</strong> As described in <a href="#Sato2009">Sato et al. 2009</a> and in <a href="#Schwank2013">Schwank et al. 2013</a>, here both culture expansion and imaging were performed by Gerald Schwank</em>.</p>
<p>Crypts were released from murine small intestine in PBS/EDTA. Single crypts were mixed and plated in Matrigel (BDBioscience) in 24-well plates. After polymerization, Matrigel was supplemented with crypt culture medium containing growth factors (EGF, R-spondin, and Noggin).</p>
<p>Single crypts were cultured for two generations under conditioned medium enriching for stem cells. The resulting organoids were mechanically dissociated and trypsinized to obtain single cells. Dissociated cells were collected in culture medium and embedded in Matrigel supplemented with growth factors at 1 cell per well (in 96-well plates).</p>
<p>Organoids were directly genetically manipulated either by electroporation or by liposome-mediated transfection. Both methods were used to transfect organoids with the histone H2A-GFP BAC. After two days, stable clones were selected for G814 resistance as well as for ubiquitious expression of H2A-GFP.</p>
<h2 id="image-acquisition">Image acquisition</h2>
<p>After selection and conditioned medium removal, sphere-like organoids started to shape into crypt-villus domains. Imaging started 24h upon the first bud event for most of the organoids.</p>
<p>All images were acquired at 40× magnification (high numerical aperture objective) on a confocal PerkinElmer Ultraview VoX spinning disk microscope equipped with a high-resolution charge-coupled device (CCD) camera and controlled by Volocity software.</p>
<p>At each time point (20 minutes interval), we sequentially acquired three-dimensional stacks of fluorescence images for GFP (H2A-EGFP). Our exposure times were roughly 200 ms. The pixel size was 0.32 μm, and the spacing between consecutive planes in our stacks was 1.0 μm yielding an anisotropic voxel size. Organoid evolution was followed up to 48 hours.</p>
<h1 id="results-and-discussion">Results and discussion</h1>
<hr />
<h2 id="image-analysis">Image analysis</h2>
<p>After image acquisition, images were cropped in XY to a bounding box covering the organoid by its totality. Moreover the image stack was cropped in Z, as intensity and contrast were reduced due to photon scattering and the limited depth capacity of the confocal system. The typical workflow for tracking starts by the segmentation, where pixels are classified as background or foreground. Then, collective movements are adjusted by cross correlation which serves as a preprocessing step for tracking. After single objects are identified, 2 classifiers learn from the manual labeling of division and merge events. Finally trajectories of each cell are assigned and merging events resolved (see <strong>Figure 5</strong>).</p>
<p><a class="fancybox" rel="organoid" href="/static/images/organoid/image-analysis_workflow.png" title="organoid"><img src="/static/images/organoid/image-analysis_workflow.png" style="background-color:#fff; max-width: 60%; max-height: 400px;" alt="org9" /></a>
<p class="caption" style="width: 60%;"><b>Figure 5. <em>ILASTIK</em> workflow</b> Raw data is segmented into background and foreground from which the objects are extracted. Collective movement is used to adjust object displacements by patch-wise cross correlation. Object classification for division and merger events determine unary potentials later used to solve the proposed factor graph and find a globally consistent tracking solution. Detections identified as possible mergers are resolved in a last step. (scanned from a printed draft for <a href="#Schiegg2013">Schiegg et al. 2013</a>)</p></p>
<h3 id="segmentation">Segmentation</h3>
<p>In our particular case, the main objective was the three dimensional segmentation, hence, to classify each pixel either as foreground (fluorescently labeled nuclei) or as background. For this purpose, <em>ILASTIK</em> uses a special kind of decision trees, called random forests (<a href="#Breiman2001">Breiman 2001</a>). Decision trees are a tool used in machine learning to predict the membership of objects &mdash;in this case pixels&mdash; on a determined class &mdash; in this case foreground or background.</p>
<p>In a tree, a path from the root to a leaf, represents classification rules learned from categorically dependent variables (i.e.foreground, background) measured from one or more predictor variables (features, like intensity, edge and texture). For our binary partition, measurements of features like intensity, edge and texture descriptors for each class were learned by the manual labeling (brush strokes) of a small set of regions, afterward, a random forest classifier is trained with the input labels (see <strong>Figure 6b</strong>).</p>
<p>Each classification tree in the random forest classifier is built form a bootstrap sample of the training data (sampling with replacement). The prediction for each pixel is then classified given the mode of the collected output of the random forest (100 decision trees).</p>
<p>The features where selected by visual inspection such that each of them reveled or enhanced relevant features which provide informative hints for the segmentation of each class. Likewise, as <em>ILASTIK</em> provides means for interactive learning, the manual classification was fine-tuned until foreground regions resembled in shape that of the nuclei and the regions in between nuclei were classified as background.</p>
<p>For the computation of the features, the parameters for the default algorithm were modified to process anisotropic data. For our voxel size, the settings were adapted to support a scale of 1:1:3 (x:y:z).</p>
<h3 id="object-extraction-and-classification">Object extraction and classification</h3>
<p>From the previously described task we obtained a prediction for the membership of a pixel in its assigned class which we later thresholded to 0.5 for the foreground segmented objects (see <strong>Figure 6c</strong>). We proceeded with object extraction, in this step the connected components were identified and assigned an id for use in later steps (see <strong>Figure 6d</strong>). Here we extracted an average of 228 objects in each time step. </p>
<p>Before the final tracking step, prior learning for both the division-detection classifier and the cell classifier was performed. In the former, cells identified as dividing were labeled in the time step before division, as well, cells not dividing could be labeled. In both cases around 10 objects were assigned a class. We also labeled for misidentified or under-segmented objects which will provide the local evidence for later resolving mergers (see <strong>Figure 6e</strong>). </p>
<p><a id="figure-6"class="fancybox" rel="organoid" href="/static/images/organoid/ilastik_main_2.png" title="organoid"><img class="album-item" src="/static/images/organoid/ilastik_main_2.png" style="background-color:#fff; max-width: 210px; margin-left: 5px;" alt="org1" /></a>
<a class="fancybox" rel="organoid" href="/static/images/organoid/ilastik_training.png" title="organoid"><img class="album-item" src="/static/images/organoid/ilastik_training.png" style="background-color:#fff; max-width: 210px; margin-left: 5px;" alt="org1" /></a>
<a class="fancybox" rel="organoid" href="/static/images/organoid/ilastic_predictions.png" title="organoid"><img class="album-item" src="/static/images/organoid/ilastic_predictions.png" style="background-color:#fff; max-width: 210px; margin-left: 5px;" alt="org1" /></a>
<a class="fancybox" rel="organoid" href="/static/images/organoid/ilastik_object_extraction_2.png" title="organoid"><img class="album-item" src="/static/images/organoid/ilastik_object_extraction_2.png" style="background-color:#fff; max-width: 210px; margin-left: 5px;" alt="org1" /></a>
<a class="fancybox" rel="organoid" href="/static/images/organoid/ilastik_cell_class.png" title="organoid"><img class="album-item" src="/static/images/organoid/ilastik_cell_class.png" style="background-color:#fff; max-width: 210px; margin-left: 5px;" alt="org1" /></a>
<p class="caption" id="caption-6" style="width: 90%;"><strong>Figure 6. Segmentation and tracking with ILASTIK. </strong><strong>a.</strong> The hyperstack of three-dimensional images of the organoid were loaded into <em>ILASTIK</em>. <strong>b.</strong> Both foregorund (green) and backgorund (red) were manually labeled on a small set of regions ( mouse cursor is also shown in green) <strong>c.</strong> After segmentation we obtained prediction maps which we  later thresholded for foreground objects <strong>d.</strong>  After thresholding connected components were identified and assigned an individual identifier (randomly color-labeled) <strong>e.</strong> Cell classification step, prior to tracking. Misidentified, single and merged objects were manually assigned a class (single cells in green, merger events of two cells in yellow).</p></p>
<h3 id="tracking">Tracking</h3>
<p>Tracking is intended for means to record the trajectory of an object over time. Our targets were the cells identified by the fluorescently labeled nuclei, later segmented. The problem is to find a configuration of cell trajectories which explains better the transitions of all objects between frames across the whole time-lapse.</p>
<p>The method <em>ILASTIK</em> implements is based on a tracking-by-assignment strategy in which every detection is treated as a potential target itself. This is particularly challenging, since cells are dividing, additionally, they constantly appear and disappear from the field of view (<a href="#Schiegg2013">Schegg et al. 2013</a>). This problem is approached by probabilistic graphical models which are further restricted to conservation laws for the number of objects in each detection to ensure global consistency of the solution. </p>
<p>The model associates to each detected object a set of three different variables, <em>detection variables</em>, <em>division variables</em> and <em>transition variables</em> (see <strong>Figure 7</strong>). Into the detection variables, the model integrates appearance and disappearance of objects in the segmented image. Both events are penalized with a unary potential calculated with a random forest trained on local features like size of the connected component. Likewise, the division variable uses a unary potential determined by a probabilistic classifier trained with local evidence from the interactive labeling of dividing cells. Transition variables indicate the number of objects which are assigned to the transition of another object. Detections (an object upon assignation across all time steps) are handled simultaneously in the holistic graphical model on which inference is performed globally (<a href="#Schiegg2013">Scheigg et al. 2013</a>) afterward, object merging is approached with Gaussian mixture models.</p>
<p><a class="fancybox" rel="organoid" href="/static/images/organoid/tracking-hypotesis.png" title="click to enlarge"><img src="/static/images/organoid/tracking-hypotesis.png" style="background-color:#fff; max-width: 60%; max-height: 400px;"/></a>
<p class="caption" style="width: 60%;"><b>Figure 7. Tracking-by-assignment model used in <em>ILASTIK</em>. </b> For each detection, different events are considered given the objects (green) association through time. The factor graphs of each event at time t are characterized by three detection variables. Together they account for appearance, vanishing, merging and division events. (scanned from a printed draft for <a href="#Schiegg2013">Schiegg et al. 2013</a>)</p></p>
<p>As cells might move with different velocities and/or cells can undergo collective displacement, object movement is adjusted in a preprocessing step using patch-wise cross correlation in order to prevent bias towards slow moving objects, additionally this also accounts for small variations in imaging due to the microscope stage drift.</p>
<p>For the analysis of this particular dataset (see <strong>Figure 8</strong>) we went though several rounds of trial and error both for the pixel classification training step, as well as for the parameter selection for the dis/appearance penalty. Finally we set the parameters of B<sub>o</sub> to 0.5, and the dis/appearance penalty to 500, the remaining parameters were left as default (division and transition parameters). Finally we achieved a good segmentation, where just a couple of nuclei continued to be merged, however such cases couldn't be resolved since they appeared late in the time course and remained so until the last time point.</p>
<p><a class="fancybox" rel="organoid" href="/static/images/organoid/organoid_01.gif" title="organoid"><img src="/static/images/organoid/organoid_01.gif" style="background-color:#fff; max-width: 60%;" alt="org11" /></a>
<p class="caption" style="width: 60%;"><b>Figure 8. Raw image stack. </b>Spinning disc microscopy images of the organoid at different planes at one single time point</p></p>
<p>Regarding the assignment of trajectories we observed a very low number of correct cases. This is due to the poor time resolution, where abrupt changes are found from one time point to the next, and even by visual inspection it was hard to assign an unambiguous trajectory. Finally, we rendered the results in MATLAB. (see <strong>Figure 9</strong>).</p>
<p><a class="fancybox" rel="organoid" href="/static/images/organoid/organoid_segmentation.gif" title="organoid"><img src="/static/images/organoid/organoid_segmentation.gif" style="background-color:#fff; max-width: 60%;" alt="org12" /></a>
<p class="caption" style="width: 60%;"><b>Figure 9. Tracking result.</b> The resulting segmentation and tracking (randomly color coded) was rendered with MATLAB. Cells with same identity are the same color, however some color labels cannot be distinguished despite their independent identities due to the assignation process which is random.</p></p>
<h3 id="implementation-of-an-edge-aware-penalty-function">Implementation of an edge-aware penalty function</h3>
<p>Here we additionally replaced the design parameters for the appearance and disappearance penalty. From the natural observation that objects which are closer to the edge of the <em>field-of-view</em> (FOV) appear and vanish frequently, we decided to penalize them accordingly. We replaced the default constant parameters with a function aware of the distance of the objects to the edge after a given margin. The function we used is designed such that it returns values between 0 and 1, thus, we can scale a penalty value as a function of the object distance to the edge. In this case we selected a logistic functions which can be further parametrized (B<sub>o</sub>) and yield a function from a family of curves between a linear and a step function (see <strong>Figure 10</strong>).</p>
<p><a class="fancybox" rel="organoid" href="/static/images/organoid/edge_penalty.png" title="click to enlarge"><img src="/static/images/organoid/edge_penalty.png" style="background-color:#fff; max-width: 60%; max-height: 400px;"/></a>
<p class="caption" style="width: 60%;"><strong>Figure 10. Logistic function familly</strong> We used a normalized version of the logistic function: $f(x) = \frac{1}{1 + e^{-B_{o}x}}$ in the domain [-10,10] shifted to have have positive values as input. The penalty for appearance and disappearance is defined as a function of the object localization with respect to the FOV edge. An object has a distance of 0 if is located at the edge and of 1 if it is located at the margin. The penalty function is parametrized by B<sub>o</sub>. Depending on its value the function is linear or step-like at the extremes.</p></p>
<h1 id="concluding-remarks">Concluding remarks</h1>
<hr />
<p><em>ILASTIK</em> is capable of segmenting and tracking the organoid dataset. The toolkit needed to be specifically fine-tuned to meet the requirements of this particular dataset. The task proved to be difficult, as the results were visually assessed and the assigned trajectories were not always correct throughout the totality of the time-lapse. Apart from the erratic movements of the organoid within the FOV, we link these misassignments to the fact that the organoid was not imaged as a whole. Furthermore, as the contrast decreased along the z-axis, the number of mergers increased. Despite we reduced the number of possible mergers by further cropping the stack, and keeping the high contrast planes, the capacity to prove the consistency of the model was diminished (information was lost) as fewer cells were captured; this resulted in some actual cell nuclei to be classified as misdetections. To reduce misdetection of nuclei and  to improve the tracking, we then tried to fine-tune the algorithm by differently penalizing the appearance and disappearance of cells into and out of the FOV. We replaced a constant penalty value with a sigmoid function from which steepness parameter can be provided, thus the penalty can be tuned from a smooth to a step function penalty regime. Finally this function was integrated into <em>ILASTIK</em> both in the implementation and in the graphical user interface. The implementation of the new penalty regime for dis/appearances reduced the number of actual nuclei to be assigned as misidentifications. This also improved the tracking capabilities for this specific dataset. However, further evaluation should be performed with manual tracking (a time consuming task). We finally suggest the replacement of the used imaging schema in order to improve both depth and acquisition time. Spinning disk microscopy is already faster compared to other LSM methods, however it falls short when imaging samples in the range of hundreds of micrometers (as in the case of organoids). We previously discussed the advantages of SPIM and we suggest this approach to be used with the organoids. By meeting the mentioned suggestion, a better  comparison of wild-type <em>vs</em> perturbation experiments can be reached, further shedding light into the mechanisms of tissue regeneration and organization.</p>
<h1 id="aknowledgements">Aknowledgements</h1>
<hr />
<p>In the frame of the Master in biosciences at the University of Heidelberg, this project was carried out from May to June 2013 during a 7 week internship supported by Prof. Fred A. Hamprecht in his group: Multidimensional Image Analysis at the Heidelberg Image Collaboratory. It was supervised by Martin Schiegg from the same group, while the image data was generated by Gerald Schwank from the group of Prof. Hans Clevers at the Hubrecht Institute in Utrecht. I would like to thank Martin and Gerald as well as Prof. Hamprecht for their help, advice, and room for collaboration.</p>
	<h1>References</h1>
		<div id="bibliography" style="font-size:0.9em;">
		    <ol>
			    <li id="Barker2009">Barker Nick, Ridgway Rachel a, van Es Johan H, van de Wetering Marc, Begthel Harry, van den Born Maaike, Danenberg Esther, Clarke Alan R, Sansom Owen J, Clevers Hans. (2009) <a href=http://www.ncbi.nlm.nih.gov/pubmed/19092804>Crypt stem cells as the cellsoforigin of intestinal cancer.</a> <em>Nature</em> 457: 608--11.
			    </li>
			    <li id="Barker2007">Barker Nick, van Es Johan H, Kuipers Jeroen, Kujala Pekka, van den Born Maaike, Cozijnsen Miranda, Haegebarth Andrea, Korving Jeroen, Begthel Harry, Peters Peter J, Clevers Hans. (2007) <a href=http://www.ncbi.nlm.nih.gov/pubmed/17934449>Identification of stem cells in small intestine and colon by marker gene Lgr5.</a> <em>Nature</em> 449: 1003--7.
			    </li>
			    <li id="Breiman2001">Breiman Leo. (2001) <a href=&nbsp;>Random Forests.</a> <em>Machine Learning</em> 45: 5--32.
			    </li>
			    <li id="Clevers2013">Clevers Hans. (2013) <a href=http://www.ncbi.nlm.nih.gov/pubmed/23870119>The intestinal crypt a prototype stem cell compartment.</a> <em>Cell</em> 154: 274--84.
			    </li>
			    <li id="Huisken2004">Huisken Jan, Swoger Jim, Del Bene Filippo, Wittbrodt Joachim, Stelzer Ernst H K. (2004) <a href=http://www.ncbi.nlm.nih.gov/pubmed/15310904>Optical sectioning deep inside live embryos by selective plane illumination microscopy.</a> <em>Science (New York, N.Y.)</em> 305: 1007--9.
			    </li>
			    <li id="Kausler2012">Kausler Bernhard X, Schiegg Martin, Andres Bjoern, Lindner Martin, Koethe Ullrich, Leitte Heike, Wittbrodt Joachim, Hamprecht Fred A.. (2012) <a href=&nbsp;>A Discrete Chain Graph Model for 3d  t Cell Tracking with High Misdetection Robustness.</a> <em>European Conference on Computer Vision (ECCV)</em> 1: 1--14.
			    </li>
			    <li id="Oates2009">Keller Philipp J. (2013) <a href=&nbsp;>Imaging Morphogenesis Technological Advances and Biological Insights.</a> <em>Science</em> 340: 1234168.
			    </li>
			    <li id="Keller2008">Keller Philipp J, Schmidt Annette D, Wittbrodt Joachim, Stelzer Ernst H K. (2008) <a href=&nbsp;>Reconstruction of Zebrafish Early Light Sheet Microscopy.</a> <em>Science</em> 322: 1065--1069.
			    </li>
			    <li id="Moore2013">Moore Julia L, Du Zhuo, Bao Zhirong. (2013) <a href=http://www.ncbi.nlm.nih.gov/pubmed/23861063>Systematic quantification of developmental phenotypes at singlecell resolution during embryogenesis.</a> <em>Development (Cambridge, England)</em> 140: 3266--74.
			    </li>
			    <li id="Oates2009c">Oates Andrew C, Gorfinkiel Nicole, Gonzalez-Gaitan Marcos, Heisenberg Carl-Philipp. (2009) <a href=http://www.ncbi.nlm.nih.gov/pubmed/19584811>Quantitative approaches in developmental biology.</a> <em>Nature reviews. Genetics</em> 10: 517--30.
			    </li>
			    <li id="Radtke2005">Radtke Freddy, Clevers Hans. (2005) <a href=http://www.ncbi.nlm.nih.gov/pubmed/15790842>Selfrenewal and cancer of the gut two sides of a coin.</a> <em>Science (New York, N.Y.)</em> 307: 1904--9.
			    </li>
			    <li id="Reya2005">Reya Tannishtha, Clevers Hans. (2005) <a href=http://www.ncbi.nlm.nih.gov/pubmed/15829953>Wnt signalling in stem cells and cancer.</a> <em>Nature</em> 434: 843--50.
			    </li>
			    <li id="Sato2013">Sato Toshiro, Clevers Hans. (2013) <a href=http://www.ncbi.nlm.nih.gov/pubmed/23744940>Growing selforganizing miniguts from a single intestinal stem cell mechanism and applications.</a> <em>Science (New York, N.Y.)</em> 340: 1190--4.
			    </li>
			    <li id="Sato2011">Sato Toshiro, Stange Daniel E, Ferrante Marc, Vries Robert G J, Van Es Johan H, Van den Brink Stieneke, Van Houdt Winan J, Pronk Apollo, Van Gorp Joost, Siersema Peter D, Clevers Hans. (2011) <a href=http://www.ncbi.nlm.nih.gov/pubmed/21889923>Longterm expansion of epithelial organoids from human colon adenoma adenocarcinoma and Barretts epithelium.</a> <em>Gastroenterology</em> 141: 1762--72.
			    </li>
			    <li id="Sato2009">Sato Toshiro, Vries Robert G, Snippert Hugo J, van de Wetering Marc, Barker Nick, Stange Daniel E, van Es Johan H, Abo Arie, Kujala Pekka, Peters Peter J, Clevers Hans. (2009) <a href=http://www.ncbi.nlm.nih.gov/pubmed/19329995>Single Lgr5 stem cells build cryptvillus structures in vitro without a mesenchymal niche.</a> <em>Nature</em> 459: 262--5.
			    </li>
			    <li id="Schiegg2013">Schiegg M., Hanslovsky P., Kausler B. X., Hufnagel L., Hamprecht F. A.. (2013) <a href=&nbsp;>Conservation Tracking.</a> <em>IEEE International Conference on Computer Vision (ICCV 2013)</em> 10: 517--30.
			    </li>
			    <li id="Schwank2013">Schwank Gerald, Andersson-Rolf Amanda, Koo Bon-Kyoung, Sasaki Nobuo, Clevers Hans. (2013) <a href=http://dx.plos.org/10.1371/journal.pone.0076871>Generation of BAC Transgenic Epithelial Organoids.</a> <em>PLoS ONE</em> 8: e76871.
			    </li>
			    <li id="Sommer2011">Sommer Christoph, Straehle Christoph, Kothe Ullrich, Hamprecht Fred a.. (2011) <a href=http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=5872394>Ilastik Interactive learning and segmentation toolkit.</a> <em>2011 IEEE International Symposium on Biomedical Imaging: From Nano to Macro</em> &nbsp;: 230--233.
			    </li>
		    </ol>
		</div>
	<div id="toTop">
	  <a href="#mainContent"><img src="/static/images/totop2.png" alt="return to top"></a>
	</div>
</div>
            <div class="clear"></div>
			<div id="posts-footer">	<p>This entry is under category: <a href="../../showcase/" title="category">showcase</a>
</br>and was tagged as: <a href="../../tag/research.html" title="tag">research</a>, <a href="../../tag/organoid.html" title="tag">organoid</a>, <a href="../../tag/image-processing.html" title="tag">image processing</a>,  and <a href="../../tag/hci.html" title="tag">HCI</a>.</p>
</div>
		</div>
		<div id="footer">
			<p>sndbx.be &#169; <a href="../../about/" title="Interested in learning more about this site?">2013</a> Powered by <a href="http://getpelican.com/" title="Pelican">Pelican</a></br>handcrafted by Emiliano Izquierdo</br>Last modified on 2013-11-28</p>
		</div>
<script type="text/javascript">


var myHeader = $('#my_fixable_header');
myHeader.data( 'position', myHeader.position() );
$(window).scroll(function(){
    var hPos = myHeader.data('position'), scroll = getScroll();
    $('#header-wrapper').css("-webkit-transform","translateY("+ (scroll.top/3) +"px)");
    $('#my_fixable_header').css("box-shadow", "0 5px 10px 0 #bbb");
    if ( hPos.top < scroll.top ){
        myHeader.addClass('fixed');
        $('#my_fixable_header').css("box-shadow", "0 5px 10px 0 #bbb");
        $('#mainContainer').css("margin","margin: 5px auto;");
    }
    else {
        myHeader.removeClass('fixed');
        $('#mainContainer').css("margin","margin: 0 auto;");
    }
    
    if (scroll.top < 200) {
      $('#my_fixable_header').css("opacity", (scroll.top * 0.005) );
      $('#header').css("opacity", ( 1- (scroll.top * 0.005)) );
       $('#nav').css("opacity", ( 1- (scroll.top * 0.005)) );
      $('#header-wrapper').css("background-color","rgba(204,255,0," + (scroll.top * 0.005) + ")");
    } else {
      $('#my_fixable_header').css("opacity", 1);
        $('#header-wrapper').css("background-color","rgba(204,255,0,1)");
    }
   
    
    if ( scroll.top == 0 ){
        $('#my_fixable_header').css("box-shadow", "none");
        $('#my_fixable_header').css("opacity", 0);
        $('#header').css("opacity", 1 );
       $('#nav').css("opacity", 1 );
        $('#header-wrapper').css("background-color","#fafafa");
    }
    
    
    
});

function getScroll () {
    var b = document.body;
    var e = document.documentElement;
    return {
        left: parseFloat( window.pageXOffset || b.scrollLeft || e.scrollLeft ),
        top: parseFloat( window.pageYOffset || b.scrollTop || e.scrollTop )
    };
}
    

</script>
		

    </body>
</html>